# SimpleRPA 功能使用指南

## 目录

1. [动作组管理](#动作组管理)
2. [动作执行控制](#动作执行控制)
3. [状态保存与恢复](#状态保存与恢复)
4. [界面布局说明](#界面布局说明)

---

## 动作组管理

### 创建动作组

1. 在脚本列表中选择一个或多个动作
2. 右键点击选中的动作
3. 选择"保存为动作组..."
4. 输入动作组名称和描述（可选）
5. 点击"保存"

### 添加动作组到脚本

1. 在脚本列表中右键点击空白处或某个动作
2. 选择"添加动作组"子菜单
3. 从列表中选择要添加的动作组
4. 动作组中的所有动作将被插入到指定位置

### 动作组视觉标识

- 从动作组添加的动作会显示 `📁 动作组名` 标识
- 方便识别哪些动作来自动作组

### 编辑动作组

1. 在左侧"动作组"面板中找到要编辑的动作组
2. 点击展开按钮（箭头图标）查看组内所有动作
3. 点击编辑按钮（铅笔图标）修改名称和描述

### 删除动作组

1. 在左侧"动作组"面板中找到要删除的动作组
2. 点击删除按钮（垃圾桶图标）
3. 确认删除操作

---

## 动作执行控制

### 基本执行设置

| 设置项 | 说明 |
|--------|------|
| 执行速度 | 控制动作执行的速度倍率（0.1x - 10x） |
| 重复次数 | 设置脚本重复执行的次数（1 - 999） |
| 无限循环 | 勾选后脚本将无限循环执行 |
| 超时设置 | 设置自动停止的超时时间（秒），0表示不限制 |

### 有限重复模式

1. 设置"重复次数"为所需数值
2. 确保"无限循环"未勾选
3. 点击"运行"开始执行
4. 状态栏显示当前轮次进度（如：第 3/5 轮）

### 无限循环模式

1. 勾选"无限循环"复选框
2. "重复次数"输入框将自动禁用
3. 可选：设置"超时设置"作为自动退出条件
4. 点击"运行"开始执行
5. 状态栏显示当前轮次（如：第 15 轮）
6. 点击"停止"按钮手动停止执行

### 超时自动停止

- 设置超时时间后，脚本执行超过该时间将自动停止
- 适用于需要限制执行时长的场景
- 设置为0表示不启用超时限制

### 执行状态显示

| 状态 | 说明 |
|------|------|
| 就绪 | 程序已启动，等待操作 |
| 正在执行... 第 X/Y 轮 | 有限重复模式的进度显示 |
| 正在执行... 第 X 轮 | 无限循环模式的轮次显示 |
| 已暂停 | 脚本执行已暂停 |
| 执行完成 | 脚本已成功完成所有动作 |
| 执行错误 | 执行过程中发生错误 |

---

## 状态保存与恢复

### 自动保存的内容

程序关闭时自动保存以下状态：

| 内容 | 说明 |
|------|------|
| 窗口位置和大小 | 主窗口的位置和尺寸 |
| 绑定的目标窗口 | 选择的目标窗口信息 |
| 打开的标签页 | 所有打开的脚本标签页及其内容 |
| 当前标签页 | 当前活动的标签页索引 |
| 执行设置 | 无限循环和超时设置 |

### 自动恢复

程序启动时自动恢复上次关闭时的状态：

1. 窗口位置和大小恢复
2. 目标窗口自动选择（如果窗口仍存在）
3. 所有标签页及其内容恢复
4. 当前标签页恢复
5. 执行设置恢复

### 配置文件位置

配置文件存储在：`~/.simpleRPA/config.json`

动作组文件存储在：`~/.simpleRPA/groups/`

---

## 界面布局说明

### 侧边导航栏

| 图标 | 功能 |
|------|------|
| 🏠 主页 | 显示主界面 |
| 📄 任务管理 | 管理打开的脚本标签页 |
| ➕ 新建 | 创建新的脚本标签页 |
| 📁 打开 | 打开已保存的脚本文件 |
| 💾 保存 | 保存当前脚本 |
| 📤 导出 | 导出为Python脚本 |

### 左侧面板

- **动作列表**：所有可用动作类型，双击添加到脚本
- **录制控制**：录制鼠标和键盘操作
- **动作组**：已保存的动作组列表

### 中间区域

- 脚本编辑器，显示当前脚本的所有动作
- 支持拖拽排序
- 右键菜单提供更多操作

### 右侧面板

- 属性面板，编辑选中动作的参数
- 效果预览按钮

### 状态栏

- 左侧：当前状态信息
- 右侧：鼠标屏幕坐标

---

## 快捷操作

| 操作 | 说明 |
|------|------|
| 双击动作 | 添加到脚本末尾 |
| 右键动作 | 打开上下文菜单 |
| 拖拽动作 | 调整动作顺序 |
| Delete键 | 删除选中的动作 |
| Ctrl+C | 复制选中的动作 |
| Ctrl+V | 粘贴动作 |

---

## 常见问题

### Q: 动作组中的动作可以单独编辑吗？

A: 可以。添加到脚本后，动作组中的动作与普通动作相同，可以单独编辑、删除或移动。

### Q: 无限循环模式如何退出？

A: 点击"停止"按钮手动停止，或设置超时时间自动停止。

### Q: 为什么恢复的目标窗口不正确？

A: 如果目标窗口已关闭或标题改变，可能无法正确恢复。请重新选择目标窗口。

### Q: 动作组删除后，已添加到脚本的动作会消失吗？

A: 不会。动作组只是模板，添加到脚本的动作是独立的副本。

---

## 技术支持

如有问题或建议，请访问项目主页提交Issue。
